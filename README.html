<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ AI Code Agent - Setup & Installation</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        .header {
            background: rgba(255,255,255,0.1);
            color: white;
            padding: 2rem;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 300;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .nav-breadcrumb {
            background: rgba(255,255,255,0.9);
            padding: 1rem 2rem;
            font-size: 0.9rem;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .nav-breadcrumb a {
            color: #2E86AB;
            text-decoration: none;
        }
        
        .nav-breadcrumb a:hover {
            text-decoration: underline;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .content-section {
            background: white;
            margin: 2rem 0;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .section-header {
            background: linear-gradient(135deg, #2E86AB, #A23B72);
            color: white;
            padding: 1.5rem 2rem;
            font-size: 1.3rem;
            font-weight: 500;
        }
        
        .section-content {
            padding: 2rem;
        }
        
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .alert {
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 6px;
            border-left: 4px solid;
        }
        
        .alert-info {
            background: #e3f2fd;
            border-color: #2196f3;
            color: #1565c0;
        }
        
        .alert-warning {
            background: #fff3e0;
            border-color: #ff9800;
            color: #ef6c00;
        }
        
        .alert-success {
            background: #e8f5e8;
            border-color: #4caf50;
            color: #2e7d32;
        }
        
        .step-list {
            counter-reset: step-counter;
        }
        
        .step {
            counter-increment: step-counter;
            margin: 2rem 0;
            padding: 1.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            position: relative;
        }
        
        .step::before {
            content: counter(step-counter);
            position: absolute;
            top: -10px;
            left: 20px;
            background: #2E86AB;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .step h3 {
            color: #2E86AB;
            margin-bottom: 1rem;
            margin-left: 20px;
        }
        
        .quick-links {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .quick-links h4 {
            margin-bottom: 1rem;
            color: #2E86AB;
        }
        
        .quick-links ul {
            list-style: none;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
        }
        
        .quick-links a {
            color: #2E86AB;
            text-decoration: none;
            padding: 0.3rem 0;
            display: block;
        }
        
        .quick-links a:hover {
            text-decoration: underline;
        }
        
        .service-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }
        
        .service-table th,
        .service-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .service-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2E86AB;
        }
        
        .service-table tr:hover {
            background: #f8f9fa;
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 2rem; }
            .container { padding: 1rem; }
            .quick-links ul { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üöÄ AI Code Agent Setup</h1>
        <p>Complete Installation & Configuration Guide</p>
    </div>
    
    <div class="nav-breadcrumb">
        <a href="/">üè† Portfolio Home</a> ‚Üí <a href="docs/">üìö Documentation Hub</a> ‚Üí üöÄ Setup Guide
    </div>

    <div class="container">
        <!-- Quick Links -->
        <div class="quick-links">
            <h4>üîó Related Documentation</h4>
            <ul>
                <li><a href="docs/md.html?path=goal.md">üéØ Project Goals & Vision</a></li>
                <li><a href="docs/">üìö Documentation Hub</a></li>
                <li><a href="architecture.html">üèóÔ∏è System Architecture</a></li>
                <li><a href="https://github.com/ADASK-B/ai-code-agent">üíæ Source Code</a></li>
            </ul>
        </div>

        <!-- Prerequisites -->
        <div class="content-section">
            <div class="section-header">üìã Prerequisites</div>
            <div class="section-content">
                <h3>Required Software</h3>
                <ul>
                    <li><strong>Docker & Docker Compose</strong> (latest version)</li>
                    <li><strong>Git</strong> for repository access</li>
                    <li><strong>8GB+ RAM</strong> recommended for LLM models</li>
                </ul>

                <h3>Required Accounts & Tokens</h3>
                <ul>
                    <li><strong>ngrok Account</strong> - Free tier sufficient (get auth token)</li>
                    <li><strong>Azure DevOps</strong> - Project with admin rights</li>
                    <li><strong>Azure DevOps PAT</strong> - Personal Access Token</li>
                </ul>

                <div class="alert alert-info">
                    <strong>üí° Optional:</strong> Claude API Key and OpenAI API Key for enhanced AI capabilities. The system works fully offline with Ollama.
                </div>
            </div>
        </div>

        <!-- Installation Steps -->
        <div class="content-section">
            <div class="section-header">üõ†Ô∏è Installation Steps</div>
            <div class="section-content">
                <div class="step-list">
                    <div class="step">
                        <h3>Clone Repository</h3>
                        <div class="code-block">
git clone https://github.com/ADASK-B/ai-code-agent.git
cd ai-code-agent
                        </div>
                    </div>

                    <div class="step">
                        <h3>Configure Environment</h3>
                        <p>Copy the example environment file and configure your settings:</p>
                        <div class="code-block">
cp .env.example .env
# Edit .env with your tokens and configuration
                        </div>
                        
                        <div class="alert alert-warning">
                            <strong>‚ö†Ô∏è Required Variables:</strong><br>
                            ‚Ä¢ <code>NGROK_AUTHTOKEN</code> - Your ngrok auth token<br>
                            ‚Ä¢ <code>AZDO_PAT</code> - Azure DevOps Personal Access Token<br>
                            ‚Ä¢ <code>AZDO_ORG</code>, <code>AZDO_PROJECT</code>, <code>AZDO_REPO</code> - Your Azure DevOps details<br>
                            ‚Ä¢ <code>WEBHOOK_SECRET</code> - Generate a random secret
                        </div>
                    </div>

                    <div class="step">
                        <h3>Start All Services</h3>
                        <p>Launch the complete system with one command:</p>
                        <div class="code-block">
# Start all 16 services
docker-compose -f docker-compose.full.yml up -d --build

# Wait for services to initialize
echo "Waiting for services to start..."
sleep 60
                        </div>
                    </div>

                    <div class="step">
                        <h3>Verify System Health</h3>
                        <p>Check that all services are running correctly:</p>
                        <div class="code-block">
# Check health monitor (all services status)
curl http://localhost:8888/health

# Verify LLM models are installed
docker exec agent-local-llm ollama list
                        </div>
                        
                        <div class="alert alert-success">
                            <strong>‚úÖ Expected Response:</strong> Health monitor should show all services as "healthy"
                        </div>
                    </div>

                    <div class="step">
                        <h3>Configure Azure DevOps Webhook</h3>
                        <p>Set up the webhook to receive PR comment events:</p>
                        <ol>
                            <li>Get ngrok tunnel URL: <code>http://localhost:4040</code></li>
                            <li>Go to <strong>Project Settings ‚Üí Service Hooks</strong> in Azure DevOps</li>
                            <li>Create <strong>"Pull request commented"</strong> Webhook</li>
                            <li>URL: <code>&lt;ngrok-tunnel-url&gt;/webhook/ado</code></li>
                            <li>Secret: Use the <code>WEBHOOK_SECRET</code> from your .env file</li>
                        </ol>
                    </div>

                    <div class="step">
                        <h3>Test the System</h3>
                        <p>Create a test PR comment to verify everything works:</p>
                        <div class="code-block">
@YourUsername /edit /1 Add error handling to the login function
                        </div>
                        
                        <div class="alert alert-info">
                            <strong>üìù Expected Behavior:</strong><br>
                            1. System receives webhook from Azure DevOps<br>
                            2. AI analyzes the intent and generates code patch<br>
                            3. Creates new branch: <code>agents/edit-{prId}-1</code><br>
                            4. Applies code changes and creates draft PR<br>
                            5. Posts status update in original PR comment
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Service Overview -->
        <div class="content-section">
            <div class="section-header">üèóÔ∏è Service Overview</div>
            <div class="section-content">
                <p>After installation, you'll have 16 services running:</p>
                
                <h3>üéØ Core Application Services (8)</h3>
                <table class="service-table">
                    <thead>
                        <tr>
                            <th>Port</th>
                            <th>Service</th>
                            <th>Purpose</th>
                            <th>Access URL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>80/8080</td>
                            <td>Traefik</td>
                            <td>Reverse Proxy & Load Balancer</td>
                            <td><a href="http://localhost:8080">localhost:8080</a></td>
                        </tr>
                        <tr>
                            <td>3001</td>
                            <td>Gateway</td>
                            <td>API Gateway for Webhooks</td>
                            <td><a href="http://localhost:3001/health">localhost:3001/health</a></td>
                        </tr>
                        <tr>
                            <td>3002</td>
                            <td>Adapter</td>
                            <td>Azure DevOps Integration</td>
                            <td><a href="http://localhost:3002/health">localhost:3002/health</a></td>
                        </tr>
                        <tr>
                            <td>3003</td>
                            <td>LLM-Patch</td>
                            <td>AI Code Generation</td>
                            <td><a href="http://localhost:3003/health">localhost:3003/health</a></td>
                        </tr>
                        <tr>
                            <td>7071</td>
                            <td>Orchestrator</td>
                            <td>Workflow Coordination</td>
                            <td><a href="http://localhost:7071">localhost:7071</a></td>
                        </tr>
                        <tr>
                            <td>4040</td>
                            <td>ngrok</td>
                            <td>External Tunnel</td>
                            <td><a href="http://localhost:4040">localhost:4040</a></td>
                        </tr>
                        <tr>
                            <td>11434</td>
                            <td>Ollama</td>
                            <td>Local LLM</td>
                            <td><a href="http://localhost:11434">localhost:11434</a></td>
                        </tr>
                        <tr>
                            <td>10000-10002</td>
                            <td>Azurite</td>
                            <td>Storage Emulator</td>
                            <td>Internal</td>
                        </tr>
                    </tbody>
                </table>

                <h3>üìä Monitoring & Observability (8)</h3>
                <table class="service-table">
                    <thead>
                        <tr>
                            <th>Port</th>
                            <th>Service</th>
                            <th>Purpose</th>
                            <th>Access URL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>8888</td>
                            <td>Health Monitor</td>
                            <td>Service Health Aggregation</td>
                            <td><a href="http://localhost:8888">localhost:8888</a></td>
                        </tr>
                        <tr>
                            <td>3000</td>
                            <td>Grafana</td>
                            <td>Monitoring Dashboards</td>
                            <td><a href="http://localhost:3000">localhost:3000</a> (admin/admin)</td>
                        </tr>
                        <tr>
                            <td>9090</td>
                            <td>Prometheus</td>
                            <td>Metrics Database</td>
                            <td><a href="http://localhost:9090">localhost:9090</a></td>
                        </tr>
                        <tr>
                            <td>3100</td>
                            <td>Loki</td>
                            <td>Log Aggregation</td>
                            <td>Access via Grafana</td>
                        </tr>
                        <tr>
                            <td>8081</td>
                            <td>cAdvisor</td>
                            <td>Container Metrics</td>
                            <td><a href="http://localhost:8081">localhost:8081</a></td>
                        </tr>
                        <tr>
                            <td>9100</td>
                            <td>Node Exporter</td>
                            <td>Host Metrics</td>
                            <td>Metrics only</td>
                        </tr>
                        <tr>
                            <td>9093</td>
                            <td>Alertmanager</td>
                            <td>Alert Notifications</td>
                            <td><a href="http://localhost:9093">localhost:9093</a></td>
                        </tr>
                        <tr>
                            <td>Internal</td>
                            <td>Promtail</td>
                            <td>Log Collection</td>
                            <td>Background service</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Troubleshooting -->
        <div class="content-section">
            <div class="section-header">üîß Troubleshooting</div>
            <div class="section-content">
                <h3>Common Issues</h3>
                
                <h4>Services not starting</h4>
                <div class="code-block">
# Check service logs
docker-compose -f docker-compose.full.yml logs [service-name]

# Restart specific service
docker-compose -f docker-compose.full.yml restart [service-name]
                </div>

                <h4>Ollama models not downloading</h4>
                <div class="code-block">
# Manually pull models
docker exec agent-local-llm ollama pull llama3.1:8b
docker exec agent-local-llm ollama pull llama3.2:1b
                </div>

                <h4>Webhook not receiving events</h4>
                <ul>
                    <li>Check ngrok tunnel is active: <code>http://localhost:4040</code></li>
                    <li>Verify webhook URL in Azure DevOps includes <code>/webhook/ado</code></li>
                    <li>Confirm webhook secret matches your <code>.env</code> file</li>
                </ul>

                <div class="alert alert-info">
                    <strong>üìö More Help:</strong> See <a href="docs/">Documentation Hub</a> for detailed troubleshooting guides and operational procedures.
                </div>
            </div>
        </div>
    </div>
</body>
</html>
