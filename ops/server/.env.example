# Server Installation Environment Variables
# Copy to .env and customize for production deployment

# =============================================================================
# Domain & TLS Configuration
# =============================================================================

# Your domain name (must point to this server's IP)
DOMAIN=your-domain.com

# Email for Let's Encrypt certificate registration
EMAIL=admin@your-domain.com

# Optional: Basic Auth for Traefik Dashboard
TRAEFIK_AUTH_USER=admin
TRAEFIK_AUTH_PASSWORD=secure-admin-password

# =============================================================================
# Core Configuration
# =============================================================================

# Environment
NODE_ENV=production
LOG_LEVEL=info

# Developer/Instance ID
DEV_ID=production

# =============================================================================
# Security Configuration
# =============================================================================

# Strong webhook secret (minimum 32 characters)
WEBHOOK_SECRET=your-very-secure-webhook-secret-change-this-in-production

# CORS origin (restrict in production)
CORS_ORIGIN=https://your-domain.com

# =============================================================================
# Azure DevOps Integration
# =============================================================================

# Your Azure DevOps organization
ADO_ORG=your-organization

# Your Azure DevOps project
ADO_PROJECT=your-project

# Personal Access Token with minimal permissions:
# - Code: Read & Write
# - Pull Requests: Read & Write
# - Project and Team: Read
ADO_TOKEN=your-personal-access-token

# =============================================================================
# LLM Configuration
# =============================================================================

# LLM Provider: stub, anthropic, openai, local
LLM_PROVIDER=anthropic

# Anthropic/Claude Configuration
ANTHROPIC_API_KEY=your-claude-api-key
ANTHROPIC_MODEL=claude-3-5-sonnet-20240620

# OpenAI Configuration (alternative to Claude)
OPENAI_API_KEY=your-openai-api-key
OPENAI_MODEL=gpt-4

# Local LLM Configuration (for vLLM, Ollama, etc.)
LOCAL_LLM_URL=http://localhost:8000/v1
LOCAL_LLM_MODEL=codellama-13b-instruct

# =============================================================================
# Database Configuration
# =============================================================================

# Supabase Configuration (recommended for production)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_KEY=your-supabase-service-key

# =============================================================================
# Performance & Limits
# =============================================================================

# Rate Limiting
RATE_SOFT_RPS=20
RATE_BURST_RPS=50

# Circuit Breaker
CIRCUIT_BREAKER_THRESHOLD=10
CIRCUIT_BREAKER_TIMEOUT=60000

# Orchestrator Limits
MAX_VARIANTS=5
VARIANT_TIMEOUT_MINUTES=10

# Patch Limits
PATCH_MAX_BYTES=500000
MAX_FILES_IN_PATCH=100

# LLM Timeout
LLM_TIMEOUT_MS=60000

# =============================================================================
# Git Configuration
# =============================================================================

# Bot identity for Git commits
GIT_USER_NAME=Code Agent Bot
GIT_USER_EMAIL=code-agent@your-domain.com

# =============================================================================
# Monitoring & Observability
# =============================================================================

# Application Insights (optional, for Azure integration)
APPINSIGHTS_INSTRUMENTATIONKEY=your-app-insights-key

# Enable request logging
ENABLE_REQUEST_LOGGING=true
ENABLE_PERFORMANCE_METRICS=true

# =============================================================================
# Storage Configuration
# =============================================================================

# Azure Storage Connection String (uses Azurite locally)
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;BlobEndpoint=http://azurite:10000/devstoreaccount1;QueueEndpoint=http://azurite:10001/devstoreaccount1;TableEndpoint=http://azurite:10002/devstoreaccount1;

# =============================================================================
# Security Headers & HTTPS
# =============================================================================

# Force HTTPS redirect
FORCE_HTTPS=true

# HSTS max age (1 year)
HSTS_MAX_AGE=31536000

# Content Security Policy
CSP_DEFAULT_SRC="'self'"
CSP_SCRIPT_SRC="'self' 'unsafe-inline'"
CSP_STYLE_SRC="'self' 'unsafe-inline'"

# =============================================================================
# Backup Configuration
# =============================================================================

# Backup retention (days)
BACKUP_RETENTION_DAYS=30

# Backup location
BACKUP_LOCATION=/opt/backups/code-agent

# =============================================================================
# Optional: External Integrations
# =============================================================================

# Slack webhook for notifications (optional)
SLACK_WEBHOOK_URL=

# Email SMTP for notifications (optional)
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=code-agent@your-domain.com

# =============================================================================
# Container Resource Limits
# =============================================================================

# Memory limits (for docker-compose)
GATEWAY_MEMORY_LIMIT=512m
ORCHESTRATOR_MEMORY_LIMIT=1g
ADAPTER_MEMORY_LIMIT=512m
LLM_PATCH_MEMORY_LIMIT=2g

# CPU limits
GATEWAY_CPU_LIMIT=1
ORCHESTRATOR_CPU_LIMIT=2
ADAPTER_CPU_LIMIT=1
LLM_PATCH_CPU_LIMIT=2

# =============================================================================
# Development/Debug Settings (disable in production)
# =============================================================================

# Traefik dashboard access (set to false in production)
TRAEFIK_DASHBOARD_ENABLED=false

# Detailed error messages (set to false in production)
DETAILED_ERRORS=false

# Debug mode
DEBUG_MODE=false
